1ï¸âƒ£ Temporary data (Rails.cache)
	Definition

	Derived, reproducible, disposable data

	Data that can be recomputed safely if it disappears.

	If cache is wiped â†’ app still works.

	Examples (very important)
	âœ… Query results
	Rails.cache.fetch("users_count") { User.count }


	If deleted â†’ DB recomputes â†’ OK.

	âœ… View fragments
		<% cache @user do %>
		  <%= render @user %>
		<% end %>


		Lost cache â†’ page re-renders â†’ OK.

	âœ… API responses
		Rails.cache.fetch("github_repos", expires_in: 10.minutes) do
		  Github.fetch_repos
		end


		API is called again â†’ OK.

	âœ… Computed values
		Rails.cache.fetch("leaderboard") { expensive_sorting }

	Key rule

		Temporary data can always be regenerated from source of truth
		(DB, API, computation)


2ï¸âƒ£ Permanent data (Redis directly)
	Definition

	Authoritative data stored because it must survive cache clears

	If Redis data is lost â†’ business breaks.

	Examples
	âœ… Counters that matter
	redis.incr("video:123:views")


	If lost â†’ view count wrong âŒ

	âœ… Rate limiting state
	redis.incr("user:1:requests")


	Lost â†’ rate limits reset âŒ

	âœ… Locks
	SET resource_lock NX EX 30


	Lost â†’ double execution âŒ

	âœ… Job deduplication
	redis.set("job:123", 1, nx: true, ex: 1.hour)

	Key rule

		Redis is the source of truth here.

3ï¸âƒ£ Business logic (Redis directly)
	Definition

	When Redis participates in decision-making

	Redis data decides what the app does.

	Examples (very interview-heavy)
	âœ… Rate limiting
	if redis.incr("user:1:reqs") > 100
	  block_request
	end


	Redis controls behavior.

	âœ… Feature flags
	redis.get("feature:new_checkout") == "on"


	âœ… Distributed locks
	unless redis.set("lock:invoice:5", 1, nx: true, ex: 30)
	  raise "Already processing"
	end

	âœ… Queues / PubSub
	redis.lpush("emails", payload)

Key rule

If Redis data affects control flow â†’ business logic



ğŸš« Why NOT use Rails.cache for permanent / business data?

	Because Rails.cache assumes:

	Data can disappear
	Data can be evicted
	Data can expire
	Data can be overwritten

	Because Rails.cache assumes data is disposable:

		Keys can expire
		Keys can be evicted
		Keys can be deleted on deploy
		Cache clears are normal
		Rails does not guarantee durability.

	Bad example âŒ

	Rails.cache.write("user_balance", 500)
	Cache eviction â†’ ğŸ’¥ wrong balance



	Final comparison table

	| Type              | Rails.cache | Redis directly           |
	| ----------------- | ----------- | ------------------------ |
	| Temporary data    | âœ… Yes       | âš ï¸ Possible but overkill |
	| Recomputable      | âœ… Yes       | âŒ Usually no             |
	| Business decision | âŒ No        | âœ… Yes                    |
	| Source of truth   | âŒ No        | âœ… Yes                    |
	| Eviction-safe     | âœ…           | âŒ                        |


Ultra-clear one-liner (memorize)

Rails.cache is for temporary, reproducible data, while Redis should be used directly when the data is permanent or part of business logic that must not be lost.


The correct distinction

Both Rails.cache keys and Redis keys CAN be deleted or missing.
The difference is expectation, guarantees, and how you design around it.




1ï¸âƒ£ Rails.cache keys

	Rails.cache is designed with the assumption that keys may disappear at any time.

	Why keys can vanish:

	TTL (expires_in)

	LRU/LFU eviction

	Rails.cache.clear

	App deploy / restart

	Store change

	Memory pressure

	ğŸ“Œ Rails.cache treats this as NORMAL behavior

	Thatâ€™s why:

	Rails.cache.fetch("key") { recompute }

	Missing key â†’ recompute â†’ OK


2ï¸âƒ£ Redis keys (used directly)

	Redis keys can also disappear, but:

	You design your system assuming they must not

	You usually:

	Control TTL carefully

	Use persistence (AOF/RDB)

	Monitor memory

	Treat Redis as authoritative

	ğŸ“Œ Missing Redis key = BUG / incident


This is the REAL difference (memorize this)

| Aspect                  | Rails.cache | Redis directly   |
| ----------------------- | ----------- | ---------------- |
| Keys can disappear      | âœ… Yes       | âœ… Yes            |
| Disappearance expected  | âœ… Yes       | âŒ No             |
| App handles miss safely | âœ… Yes       | âŒ Usually breaks |
| Source of truth         | âŒ No        | âœ… Yes            |
| Safe to evict           | âœ… Yes       | âŒ No             |
