1️⃣ What is jid?

jid = Sidekiq Job ID

Generated automatically by Sidekiq when a job is enqueued

Unique per job enqueue

Example:
CreditJob.perform_async(user.id)


Sidekiq assigns:

enqueue #	jid
1	abc123
2	def456

✅ Guaranteed unique
❌ Does not represent business action

Retry of the same job → jid stays the same

Duplicate enqueue → different jid

2️⃣ What is request_id (or business id)?

request_id = your stable business identifier

Represents a specific business action, not a job execution

You generate it yourself (UUID, order ID, webhook ID, etc.)

Example:
request_id = "order_456"
CreditJob.perform_async(user.id, request_id)


Two enqueues for the same business action:

enqueue #	jid	request_id
1	abc123	order_456
2	def456	order_456

✅ request_id is same → DB uniqueness prevents duplicate action
✅ jid is different → Sidekiq treats as separate jobs

3️⃣ Key differences
Feature	jid	request_id / business key
Generated by	Sidekiq	You (or from business data)
Uniqueness scope	Per job enqueue	Per business action
Retries handled	✅ retry same job (jid same)	✅ safe (same request_id)
Duplicate enqueue	❌ not safe (jid changes)	✅ safe (request_id same)
Use case	Internal Sidekiq tracking	Business-level idempotency
4️⃣ Mental model

jid = “this job execution instance”

request_id = “this business action”

Sidekiq cares about jid for retries, scheduling, monitoring.
You care about request_id to ensure your business action is not duplicated.

5️⃣ Example in code
Using only jid (Option 1)
def perform(user_id)
  Transaction.create!(user_id: user_id, job_id: jid)
rescue ActiveRecord::RecordNotUnique
end


Retry of same job → safe ✅

Duplicate enqueue → duplicate transaction ❌

Using request_id (Option 2, BEST)
def perform(user_id, request_id)
  Transaction.create!(user_id: user_id, job_id: request_id)
rescue ActiveRecord::RecordNotUnique
end


Retry of same job → safe ✅

Duplicate enqueue (same request_id) → safe ✅

DB uniqueness ensures business-level idempotency

TL;DR

jid = retry protection, Sidekiq internal
request_id = business action protection, prevents duplicate side effects