Login Request
   â†“
Warden authenticates
   â†“
User ID stored in Rails session
   â†“
Session stored in cookie / Redis
   â†“
Next request
   â†“
Warden reads session
   â†“
User loaded from DB


#####

âœ… Correct, Interview-Perfect Statement

When a user logs in, Warden stores the userâ€™s ID in the Rails session.
That session is persisted in a signed and encrypted cookie in the browser (by default).

âœ” Warden
âœ” Session
âœ” Cookie
âœ” Browser

All correct.

ğŸ” Small but Important Precision
What you said:

â€œwarden stores user_id in session cookieâ€

Slightly better:

Warden stores user_id in the Rails session, and Rails stores that session inside a cookie (by default).

Why this matters:

Warden â†’ session

Rails â†’ cookie

Browser â†’ stores cookie

Each layer has its responsibility.

ğŸ§  Step-by-Step Flow (Clean Mental Model)
1ï¸âƒ£ Login request
POST /users/sign_in

2ï¸âƒ£ Warden authenticates

Verifies email + password

Gets user.id

3ï¸âƒ£ Warden writes to session
session["warden.user.user.key"] = [[user.id], "auth_salt"]

4ï¸âƒ£ Rails serializes session

Encrypts & signs session hash

Stores it in a cookie

5ï¸âƒ£ Browser stores cookie

Cookie sent with every request

ğŸ” On Every Subsequent Request

Browser sends session cookie

Rails decrypts session

Warden reads user ID

User loaded from DB

current_user available

ğŸ” Is the user_id visible in the browser?

ğŸ‘‰ No

Because:

Cookie is encrypted

Cookie is signed

User cannot tamper with it

Even though stored in browser, itâ€™s secure.

ğŸš¨ Common Interview Follow-Up Traps
â“ Is password stored in cookie?

ğŸ‘‰ âŒ Never

â“ Is whole user object stored?

ğŸ‘‰ âŒ Only user ID

â“ Can user modify cookie to login as another user?

ğŸ‘‰ âŒ Signed & encrypted cookie prevents this

ğŸ¯ One-Line Interview Answer (Perfect)

â€œOn login, Warden stores the user ID in the Rails session, and Rails persists that session in a signed and encrypted cookie stored in the browser.â€