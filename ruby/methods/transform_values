What is transform_values in Ruby?

transform_values is a Hash method that lets you change only the values of a hash while keeping the keys the same.

ğŸ‘‰ Think of it as:
â€œMap over hash values, not keys.â€

ğŸ“Œ Basic Syntax
hash.transform_values { |value| new_value }


Keys stay unchanged

Values are transformed

Returns a new hash (non-mutating)

âœ… Simple Example
prices = { apple: 100, banana: 50 }

discounted = prices.transform_values { |price| price * 0.9 }

Output:
{ apple: 90, banana: 45 }


ğŸ”¹ Keys (:apple, :banana) remain the same
ğŸ”¹ Values are modified

âœ… Your Use Case (Very Important)

After group_by, you get this:

{
  "developer" => [ {..}, {..}, {..} ],
  "manager"   => [ {..}, {..} ],
  "qa"        => [ {..}, {..} ]
}


Now you want to convert each array into summary stats, without changing the role names.

Thatâ€™s exactly what transform_values is for ğŸ‘‡

grouped.transform_values do |employees|
  {
    highest_salary: employees.map { |e| e[:salary] }.max,
    lowest_salary:  employees.map { |e| e[:salary] }.min,
    avg_projects:   (employees.sum { |e| e[:projects].size }.to_f / employees.size).round(1)
  }
end


âœ”ï¸ Keys ("developer", "manager") stay the same
âœ”ï¸ Values change from arrays â†’ stats hash

ğŸ”„ How transform_values Works Internally

Ruby does something like this:

new_hash = {}

hash.each do |key, value|
  new_hash[key] = yield(value)
end


ğŸ§  Key Insight
You donâ€™t touch the key, only the value.

âŒ Without transform_values
result = {}

grouped.each do |role, employees|
  result[role] = {
    highest_salary: employees.map { |e| e[:salary] }.max,
    lowest_salary:  employees.map { |e| e[:salary] }.min,
    avg_projects:   (employees.sum { |e| e[:projects].size }.to_f / employees.size).round(1)
  }
end


âŒ More boilerplate
âŒ Less expressive

ğŸŸ¢ transform_values vs Similar Methods
Method	What it does
map	Transforms elements â†’ array
each	Iteration only
transform_keys	Changes keys
transform_values	Changes values only
each_with_object	Manual accumulation
ğŸ§  Interview One-Liner

"transform_values allows transforming the values of a hash while preserving the keys, making hash-based aggregations clean and expressive."

âš ï¸ Important Notes

Available in Ruby 2.4+

Returns a new hash

Use transform_values! for mutation

ğŸ”¥ When to Use It

Use transform_values when:

You already have correct keys

You need to compute or reshape the values

You want clean, readable Ruby