Letâ€™s clearly separate:

Class Variable â†’ @@variable

Class Instance Variable â†’ @variable inside class

They look similar but behave VERY differently.

ğŸ”¹ 1ï¸âƒ£ Class Variable (@@variable)
âœ… Defined with @@
class BankAccount
  @@count = 0

  def initialize
    @@count += 1
  end

  def self.count
    @@count
  end
end

âœ” Shared across:

The class

All instances

All subclasses â— (important)

ğŸ”¥ Problem: Shared Across Inheritance
class Parent
  @@value = 10

  def self.value
    @@value
  end
end

class Child < Parent
end

Child.value   # => 10


Now if Child changes it:

class Child
  @@value = 20
end

Parent.value  # => 20 ğŸ˜³


ğŸš¨ Parent and Child share the SAME variable.

This is why class variables are considered dangerous in Ruby.

ğŸ”¹ 2ï¸âƒ£ Class Instance Variable (@variable in class body)

Defined like this:

class BankAccount
  @interest_rate = 5

  def self.interest_rate
    @interest_rate
  end
end


Notice:

No @@

Just @

Defined inside class body

Accessed using class methods

âœ” Behavior
class Parent
  @value = 10

  def self.value
    @value
  end
end

class Child < Parent
end

Parent.value  # => 10
Child.value   # => nil


âœ… NOT shared with subclasses.

Each class has its own copy.

ğŸ”¥ Key Differences

| Feature                  | Class Variable (`@@`) | Class Instance Variable (`@`) |
| ------------------------ | --------------------- | ----------------------------- |
| Syntax                   | `@@var`               | `@var` inside class           |
| Shared across instances  | âœ… Yes                 | âŒ No                          |
| Shared across subclasses | âœ… Yes                 | âŒ No                          |
| Safe in inheritance?     | âŒ No                  | âœ… Yes                         |
| Used in Rails?           | âŒ Rarely              | âœ… Yes                         |

ğŸ”¥ Why Rails Avoids @@

Rails uses class instance variables everywhere.

Example (conceptually):

class ApplicationRecord < ActiveRecord::Base
  @abstract_class = true
end


Each model gets its own configuration.

If Rails used @@, changing one model would affect all others ğŸ˜¬

ğŸ”¥ Visual Memory Trick

Think of it like this:

@@ â†’ FAMILY SHARED BANK ACCOUNT

Everyone in inheritance tree uses same money.

@ (class instance variable) â†’ PERSONAL BANK ACCOUNT

Each class has its own.

ğŸ§  When Should You Use Which?

Almost always:

ğŸ‘‰ Use class instance variables
ğŸ‘‰ Avoid class variables unless you REALLY understand the inheritance consequences.