âœ… Recommended (most common in real systems)
Store progress on program_enrollments

and derive it from course progress

ğŸ§± Data involved
program_enrollments
id
user_id
program_id
progress_percentage
status
completed_at

course_enrollments
user_id
course_id
progress_percentage
status

program_courses
program_id
course_id
mandatory
weight

ğŸ§  How percentage is calculated
Step-by-step logic

Fetch all courses in the program

Fetch userâ€™s course enrollments for those courses

Calculate progress based on rules:

Mandatory courses only OR

Weighted average OR

Simple average

ğŸ“ Example (simple average)

Program P1 â†’ C1, C2, C3

Course	Progress
C1	100%
C2	50%
C3	0%
(100 + 50 + 0) / 3 = 50%

ğŸ—ï¸ Where is this calculated?
Option A: On-the-fly (no storage)

Always compute dynamically

Accurate but slow at scale

Option B: Derived + stored (recommended) âœ…

Recalculate when course progress changes

Store in program_enrollments.progress_percentage

â€œProgram progress is a derived value, but we persist it for fast reads.â€

This sentence = senior-level.

ğŸ” When is it updated?

When a course is completed

When progress changes

Via:

Background job or

After-commit hook

ğŸ§  Architect follow-up questions
â€œWhat if a course is optional?â€

Answer:

â€œOptional courses are excluded from the denominator unless explicitly configured.â€

â€œWhat if a course is added to the program later?â€

Answer:

â€œExisting enrollments recalculate progress based on updated program structure, or we version the program to preserve historical correctness.â€

ğŸ”¥ Thatâ€™s a director-level answer.

â€œWhy not just infer completion when all courses are done?â€

Answer:

â€œBecause progress percentage enables dashboards, analytics, and partial completion tracking without expensive queries.â€

âš ï¸ Common mistakes to avoid

âŒ storing progress only in UI

âŒ no recalculation strategy

âŒ tight coupling between course and program logic

ğŸ§  20-second interview summary

â€œProgram completion is derived from the userâ€™s course progress.
We compute it based on program rules and persist it on program_enrollments for fast reads, updating it whenever course progress changes.â€

ğŸš€ Next step

Say â€œnext: enrollment workflowâ€
Weâ€™ll walk through:

enrolling user into program

auto-enrolling into courses

transactions, idempotency, and race conditions