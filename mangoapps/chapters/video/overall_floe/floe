ğŸ¥ LMS Video Upload â†’ Playback â†’ Completion
End-to-End Architecture Flow
ğŸŸ£ PHASE 1: Admin uploads video
Admin clicks "Upload Video"
        â†“
Frontend opens upload form (chapter, title, video file)
        â†“
Frontend requests upload authorization from backend

ğŸŸ£ PHASE 2: Backend prepares upload
Backend creates Video record (status = "uploading")
        â†“
Backend generates pre-signed S3 URL
        â†“
Backend returns upload URL to frontend


ğŸ“Œ Why pre-signed URL?

Avoids routing large files through Rails

Secure + scalable

ğŸŸ£ PHASE 3: Frontend uploads video
Frontend uploads raw video directly to S3
        â†“
S3 stores raw video file
        â†“
S3 sends upload success event (or frontend notifies backend)

ğŸŸ£ PHASE 4: Backend triggers processing
Backend updates video status = "processing"
        â†“
Backend enqueues background job (Sidekiq)
        â†“
Background worker starts video processing

ğŸŸ£ PHASE 5: Video processing (backend async)
Worker downloads raw video from S3
        â†“
Transcodes video into HLS format
   - 360p
   - 720p
   - 1080p
        â†“
Generates playlist (.m3u8)
        â†“
Extracts metadata (duration, resolution)

ğŸŸ£ PHASE 6: Store processed files
Processed HLS segments uploaded to S3
        â†“
Files distributed via CDN (CloudFront)
        â†“
Backend updates Video record:
   - status = "ready"
   - duration
   - streaming_url


ğŸ“Œ CDN ensures:

Fast global delivery

No load on Rails

ğŸŸ£ PHASE 7: Learner opens video
User opens course chapter
        â†“
Frontend requests video metadata
        â†“
Backend authorizes access (RBAC + enrollment)
        â†“
Backend returns streaming URL (CDN)

ğŸŸ£ PHASE 8: Video playback starts
Browser video player loads .m3u8 playlist
        â†“
Player fetches segments dynamically from CDN
        â†“
Adaptive bitrate selection based on network


No Rails involvement here ğŸ‘ˆ

ğŸŸ£ PHASE 9: Heartbeat-based progress tracking
Every X seconds:
Frontend sends heartbeat:
  - current_time
  - playback_rate
  - video_id
        â†“
Backend validates:
  - continuous playback?
  - delta within allowed range?
        â†“
If valid:
  - Update video_progress table

ğŸŸ£ PHASE 10: Prevent cheating
User seeks forward
        â†“
Backend detects large delta
        â†“
Progress NOT updated
        â†“
User must watch continuously again

ğŸŸ£ PHASE 11: Completion check
If watched_duration â‰¥ 95%
        â†“
Mark video as completed
        â†“
Trigger chapter completion

ğŸŸ£ PHASE 12: Chapter â†’ Course â†’ Program progress
All videos in chapter completed
        â†“
Chapter marked complete
        â†“
All chapters complete â†’ course complete
        â†“
All courses complete â†’ program complete

ğŸŸ£ PHASE 13: Analytics & reporting
Progress events stored
        â†“
Used for:
  - dashboards
  - compliance reports
  - admin insights

ğŸ§  One-line summary (VERY important)

â€œVideo upload and playback are decoupled using async processing, CDN delivery, and heartbeat-based progress tracking to ensure scalability, reliability, and accurate learning completion.â€

ğŸ¯ Why this answer impresses architects

Because it shows:

Separation of concerns

Async thinking

Security awareness

Real-world failure handling

Scale readiness