Iâ€™ll walk you end-to-end: DB â†’ Rails models â†’ policy â†’ controller flow, using Instructor as the example.

Iâ€™ll keep it simple, realistic, and interview-ready.

ğŸ” RBAC Example: Instructor in Rails
ğŸ§± 1ï¸âƒ£ Database layer (source of truth)
roles
id	name
1	admin
2	coordinator
3	instructor
4	learner
permissions
id	name
1	update_course_content
2	view_course_progress
role_permissions
role_id	permission_id
3	1
3	2

â¡ Instructor does NOT have manage_users, manage_programs, etc.

users
id	name	role_id
10	Alice	3

Alice is an Instructor.

course_assignments (scope control)
id	user_id	course_id
1	10	101

Instructor is assigned to Course 101 only.

ğŸ§  Key concept (say this)

â€œRBAC decides what an instructor can do; assignments decide where they can do it.â€

ğŸ”¥ Architect-level sentence.

ğŸ§± 2ï¸âƒ£ Rails models
class User < ApplicationRecord
  belongs_to :role
  has_many :permissions, through: :role
  has_many :course_assignments
end

class Role < ApplicationRecord
  has_many :role_permissions
  has_many :permissions, through: :role_permissions
end

class Permission < ApplicationRecord
end

class CourseAssignment < ApplicationRecord
  belongs_to :user
  belongs_to :course
end

ğŸ§± 3ï¸âƒ£ Authorization Policy (Pundit-style)
CoursePolicy
class CoursePolicy
  attr_reader :user, :course

  def initialize(user, course)
    @user = user
    @course = course
  end

  def update?
    has_permission?("update_course_content") &&
      assigned_to_course?
  end

  def view_progress?
    has_permission?("view_course_progress") &&
      assigned_to_course?
  end

  private

  def has_permission?(permission)
    user.permissions.exists?(name: permission)
  end

  def assigned_to_course?
    user.course_assignments.exists?(course_id: course.id)
  end
end

ğŸ§  Whatâ€™s happening here

Role gives permission â†’ RBAC

Assignment limits scope â†’ ownership

Policy centralizes logic â†’ secure & maintainable

ğŸ§± 4ï¸âƒ£ Controller usage
class CoursesController < ApplicationController
  def update
    course = Course.find(params[:id])
    authorize course, :update?

    course.update!(course_params)
  end
end

What happens at runtime:

Instructor hits update API

Policy checks:

Does role have permission? âœ…

Is instructor assigned to course? âœ…

Action allowed

If either fails â†’ 403 Forbidden

ğŸ” Architect follow-ups & answers
â€œHow does admin access everything?â€

Answer:

â€œAdmin role has all permissions, and assignment checks are bypassed or always true for admins inside policies.â€

(Important: admin still goes through policies)

â€œHow do you add a new permission?â€

Answer:

â€œCreate permission record, attach it to roles â€” no code change required.â€

ğŸ§  30-second interview summary

â€œRBAC is implemented by mapping permissions to roles and roles to users.
Instructors inherit permissions like updating course content, but policies also enforce scope by checking course assignments.
Authorization is centralized, role-agnostic, and data-driven.â€